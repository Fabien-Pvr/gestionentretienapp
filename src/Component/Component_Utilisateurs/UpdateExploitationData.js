import { useEffect } from "react";
import { set, ref } from "firebase/database";
import { db } from "../../Services/Firebase.js";
import useGetExploitationData from "../Component_queries/UseGetexploitationData.js"; // Assurez-vous que le chemin d'importation est correct

function UpdateExploitationData({ exploitation, userId }) {
  const { exploitationInfo } = useGetExploitationData(exploitation);
  console.log("exploitationInfo", exploitationInfo);
  useEffect(() => {
    if (exploitationInfo) {
      // Copie des informations existantes et ajout de l'IdUser
      const updatedExploitationInfo = { ...exploitationInfo, IdUser: userId };
      console.log("updatedExploitationInfo", updatedExploitationInfo);
      // Mise à jour des informations dans la base de données
      const ExploitationRef = ref(db, `Exploitation/${exploitation}`);
      set(ExploitationRef, updatedExploitationInfo)
        .then(() => {
          console.log("Exploitation mise à jour avec succès !");
        })
        .catch((error) => {
          console.error(
            "Erreur lors de la mise à jour de l'exploitation :",
            error
          );
        });
    }
  }, [exploitationInfo, exploitation, userId]);
  return null;
}

export default UpdateExploitationData;
