import { useState, useEffect } from "react";
import { onValue, ref } from "firebase/database";
import { db } from "../Firebase"; // Assurez-vous que le chemin d'importation est correct

const useFindUserExploitation = (userId) => {
  const [userExploitationId, setUserExploitationId] = useState(null);

  useEffect(() => {
    const exploitationRef = ref(db, "Exploitation");

    const unsubscribe = onValue(exploitationRef, (snapshot) => {
      const exploitations = snapshot.val();
      for (const [key, value] of Object.entries(exploitations)) {
        if (value.IdUser === userId) {
          const idExploitation = value.IdExploitation;
          if (idExploitation) {
            setUserExploitationId(idExploitation);
            break;
          }
        }
      }
    });

    return () => unsubscribe();
  }, [userId]);

  return userExploitationId;
};

export default useFindUserExploitation;
